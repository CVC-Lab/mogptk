<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>mogptk.gpr.likelihood API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>mogptk.gpr.likelihood</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L1-L375" class="git-link">Browse git</a>
</summary>
<pre><code class="python">import torch
import numpy as np
from . import config, Parameter

def identity(x):
    return x

def exp(x):
    return torch.exp(x)

def inv_probit(x):
    jitter = 1e-3
    return 0.5*(1.0+torch.erf(x/np.sqrt(2.0))) * (1.0-2.0*jitter) + jitter

# also inv_logit or sigmoid
def logistic(x):
    return 1.0/(1.0+torch.exp(-x))

class GaussHermiteQuadrature:
    def __init__(self, deg=20, t_scale=None, w_scale=None):
        t, w = np.polynomial.hermite.hermgauss(deg)
        t = t.reshape(-1,1)
        w = w.reshape(-1,1)
        if t_scale is not None:
            t *= t_scale
        if w_scale is not None:
            w *= w_scale
        self.t = torch.tensor(t, device=config.device, dtype=config.dtype)  # Mx1
        self.w = torch.tensor(w, device=config.device, dtype=config.dtype)  # Mx1
        self.deg = deg

    def __call__(self, mu, var, F):
        return F(mu + var.sqrt().mm(self.t.T)).mm(self.w)  # Nx1

class Likelihood:
    def __init__(self, name=&#34;Likelihood&#34;, quadratures=20):
        self.name = name
        self.quadrature = GaussHermiteQuadrature(deg=quadratures, t_scale=np.sqrt(2), w_scale=1.0/np.sqrt(np.pi))
        self.output_dims = 1

    def validate_y(self, y):
        pass

    def log_prob(self, y, f, X=None):
        # log(p(y|f)), where p(y|f) is our likelihood
        # y: Nx1
        # f: NxM
        raise NotImplementedError()

    def variational_expectation(self, y, mu, var, X=None):
        # ∫ log(p(y|f)) q(f) df, where q(f) ~ N(mu,var) and p(y|f) is our likelihood
        # y,mu,var: Nx1
        q = self.quadrature(mu, var, lambda f: self.log_prob(y,f,X=X))  # Nx1
        return q.sum()  # sum over N

    def predictive_y(self, f, X=None):
        # f: NxM
        raise NotImplementedError()

    def predictive_yy(self, f, X=None):
        # f: NxM
        raise NotImplementedError()

    def quantile(self, p, mu, var):
        # p: scalar
        # mu,var: Nx1
        raise NotImplementedError()

    def predict(self, mu, var, X=None, full=False):
        # ∫∫ y p(y|f) q(f) df dy,  ∫∫ y^2 p(y|f) q(f) df dy - (∫∫ y p(y|f) q(f) df dy)^2
        # where q(f) ~ N(mu,var) and p(y|f) is our likelihood
        # mu,var: Nx1
        Ey = self.quadrature(mu, var, lambda f: self.predictive_y(f,X=X))
        Eyy = self.quadrature(mu, var, lambda f: self.predictive_yy(f,X=X))
        return Ey, Eyy-Ey**2

class MultiOutputLikelihood(Likelihood):
    def __init__(self, *likelihoods, name=&#34;MultiOutputLikelihood&#34;, quadratures=20):
        super().__init__(name=name, quadratures=quadratures)

        if isinstance(likelihoods, tuple):
            if len(likelihoods) == 1 and isinstance(likelihoods[0], list):
                likelihoods = likelihoods[0]
            else:
                likelihoods = list(likelihoods)
        elif not isinstance(likelihoods, list):
            likelihoods = [likelihoods]
        if len(likelihoods) == 0:
            raise ValueError(&#34;must pass at least one likelihood&#34;)
        for i, likelihood in enumerate(likelihoods):
            if not issubclass(type(likelihood), Likelihood):
                raise ValueError(&#34;must pass likelihoods&#34;)
            elif isinstance(likelihood, MultiOutputLikelihood):
                raise ValueError(&#34;can not nest MultiOutputLikelihoods&#34;)

        self.output_dims = len(likelihoods)
        self.likelihoods = likelihoods

    def _channel_indices(self, X):
        c = X[:,0].long()
        m = [c==j for j in range(self.output_dims)]
        r = [torch.nonzero(m[j], as_tuple=False).reshape(-1) for j in range(self.output_dims)]  # as_tuple avoids warning
        return r

    def validate_y(self, y):
        for likelihood in likelihoods:
            likelihood.validate_y(y)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].log_prob(y,f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].log_prob(y[r[i],:], f[r[i],:])
        return res  # NxM

    def variational_expectation(self, y, mu, var, X=None):
        # y,mu,var: Nx1
        if self.output_dims == 1:
            return self.likelihoods[0].variational_expectation(y,mu,var)

        q = torch.tensor(0.0, dtype=config.dtype, device=config.device)
        r = self._channel_indices(X)
        for i in range(self.output_dims):
            q += self.likelihoods[i].variational_expectation(y[r[i],:], mu[r[i],:], var[r[i],:]).sum()  # sum over N
        return q

    def predictive_y(self, f, X=None):
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].predictive_y(f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].predictive_y(f[r[i],:])
        return res  # NxM

    def predictive_yy(self, f, X=None):
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].predictive_yy2(f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].predictive_yy(f[r[i],:])
        return res  # NxM

    # TODO: predict is not possible?
    #def predict(self, mu, var, X=None, full=False):
    #    # mu: Nx1
    #    # var: Nx1 or NxN
    #    if self.output_dims == 1:
    #        return self.likelihoods[0].predict(mu,var,full=full)

    #    r = self._channel_indices(X)
    #    Ey = torch.empty(mu.shape, device=config.device, dtype=config.dtype)
    #    Eyy = torch.empty(var.shape, device=config.device, dtype=config.dtype)
    #    if full:
    #        for i in range(self.output_dims):
    #            r1 = r[i].reshape(-1,1)
    #            r2 = r[i].reshape(1,-1)
    #            Ey[r[i],:], Eyy[r1,r2] = self.likelihoods[i].predict(mu[r[i],:], var[r1,r2], full=True)
    #    else:
    #        for i in range(self.output_dims):
    #            Ey[r[i],:], Eyy[r[i],:] = self.likelihoods[i].predict(mu[r[i],:], var[r[i],:], full=False)
    #    return Ey, Eyy-Ey.square()

class GaussianLikelihood(Likelihood):
    def __init__(self, variance=1.0, name=&#34;Gaussian&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.variance = Parameter(variance, name=&#34;variance&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -0.5 * (np.log(2.0 * np.pi) + self.variance().log() + (y-f).square()/self.variance())
        return p  # NxM

    def variational_expectation(self, y, mu, var, X=None):
        # y,mu,var: Nx1
        p = -((y-mu).square() + var) / self.variance()
        p -= np.log(2.0 * np.pi)
        p -= self.variance().log()
        return 0.5*p.sum()  # sum over N

    def predictive_y(self, f, X=None):
        return f

    def predictive_yy(self, f, X=None):
        return f.square() + self.variance()

    def quantile(self, p, mu, var):
        return mu + torch.sqrt(2.0*var)*torch.erfinv(2.0*p - 1.0)

    def predict(self, mu, var, X=None, full=False):
        if full:
            return mu, var + self.variance()*torch.eye(var.shape[0])
        else:
            return mu, var + self.variance()

class StudentTLikelihood(Likelihood):
    def __init__(self, dof=3, scale=1.0, name=&#34;StudentT&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.dof = torch.tensor(dof, device=config.device, dtype=config.dtype)
        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -0.5 * (self.dof+1.0)*torch.log(1.0 + ((y-f)/self.scale()).square()/self.dof)
        p += torch.lgamma((self.dof+1.0)/2.0)
        p -= torch.lgamma(self.dof/2.0)
        p -= 0.5 * torch.log(self.dof*np.pi*self.scale()**2)
        return p  # NxM

    def predictive_y(self, f, X=None):
        if self.dof &lt;= 1.0:
            return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
        return f

    def predictive_yy(self, f, X=None):
        if self.dof &lt;= 2.0:
            return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
        return f.square() + self.scale()**2 * self.dof/(self.dof-2.0)

class ExponentialLikelihood(Likelihood):
    def __init__(self, link=exp, name=&#34;Exponential&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link

    def validate_y(self, y):
        if torch.any(y &lt; 0.0):
            raise ValueError(&#34;y must be positive&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -y/self.link(f) - torch.log(self.link(f))
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        return 2.0*self.link(f)**2

    def quantile(self, p, mu, var):
        return -torch.log(1.0 - p) * mu

class LaplaceLikelihood(Likelihood):
    def __init__(self, scale=1.0, name=&#34;Laplace&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -torch.log(2.0*self.scale()) - (y-f).abs()/self.scale()
        return p  # NxM

    def predictive_y(self, f, X=None):
        return f

    def predictive_yy(self, f, X=None):
        return f.square() + 2.0*self.scale()**2

    def quantile(self, p, mu, var):
        if p &lt; 0.5:
            return mu + self.scale()*torch.log(2.0*p)
        return mu - self.scale()*torch.log(2.0 - 2.0*p)

class BernoulliLikelihood(Likelihood):
    def __init__(self, scale=1.0, link=inv_probit, name=&#34;Bernoulli&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link

    def validate_y(self, y):
        if torch.any((y != 0.0) &amp; (y != 1.0)):
            raise ValueError(&#34;y must have only 0.0 and 1.0&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = self.link(f)
        return torch.log(torch.where(0.5 &lt;= y, p, 1.0-p))  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        return self.link(f)

    def quantile(self, p, mu, var):
        return torch.where(p &lt;= 1.0-mu, 0.0, 1.0)

    def predict(self, mu, var, X=None, full=False):
        if self.link == inv_probit:
            p = self.link(mu / torch.sqrt(1.0 + var))
            if full:
                return p.diagonal().reshape(-1,1), p-p.square() # TODO: correct?
            return p, p-p.square()
        else:
            return super().predict(mu, var, X=X, full=full)

class BetaLikelihood(Likelihood):
    def __init__(self, scale=1.0, link=inv_probit, name=&#34;Beta&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link
        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def validate_y(self, y):
        if torch.any((y &lt;= 0.0) | (1.0 &lt;= y)):
            raise ValueError(&#34;y must be in the range (0.0,1.0)&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        mixture = self.link(f)
        alpha = mixture * self.scale()
        beta = (1.0-mixture) * self.scale()

        p = (alpha-1.0)*torch.log(y)
        p += (beta-1.0)*torch.log(1.0-y)
        p += torch.lgamma(alpha+beta)
        p -= torch.lgamma(alpha)
        p -= torch.lgamma(beta)
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        mixture = self.link(f)
        return (mixture + mixture.square()*self.scale()) / (self.scale() + 1.0)

class GammaLikelihood(Likelihood):
    def __init__(self, shape=1.0, link=exp, name=&#34;Gamma&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link
        self.shape = Parameter(shape, name=&#34;shape&#34;, lower=config.positive_minimum)

    def validate_y(self, y):
        if torch.any(y &lt;= 0.0):
            raise ValueError(&#34;y must be in the range (0.0,inf)&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -y/self.link(f)
        p += (self.shape()-1.0)*torch.log(y)
        p -= torch.lgamma(self.shape())
        p -= self.shape()*torch.log(self.link(f))
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.shape()*self.link(f)

    def predictive_yy(self, f, X=None):
        t = self.shape()*self.link(f)
        return t + t.square()

# TODO: implement: Softmax and Poisson likelihoods?</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="mogptk.gpr.likelihood.exp"><code class="name flex">
<span>def <span class="ident">exp</span></span>(<span>x)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L8-L9" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def exp(x):
    return torch.exp(x)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.identity"><code class="name flex">
<span>def <span class="ident">identity</span></span>(<span>x)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L5-L6" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def identity(x):
    return x</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.inv_probit"><code class="name flex">
<span>def <span class="ident">inv_probit</span></span>(<span>x)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L11-L13" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def inv_probit(x):
    jitter = 1e-3
    return 0.5*(1.0+torch.erf(x/np.sqrt(2.0))) * (1.0-2.0*jitter) + jitter</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.logistic"><code class="name flex">
<span>def <span class="ident">logistic</span></span>(<span>x)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L16-L17" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def logistic(x):
    return 1.0/(1.0+torch.exp(-x))</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood"><code class="flex name class">
<span>class <span class="ident">BernoulliLikelihood</span></span>
<span>(</span><span>scale=1.0, link=&lt;function inv_probit&gt;, name='Bernoulli', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L282-L314" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class BernoulliLikelihood(Likelihood):
    def __init__(self, scale=1.0, link=inv_probit, name=&#34;Bernoulli&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link

    def validate_y(self, y):
        if torch.any((y != 0.0) &amp; (y != 1.0)):
            raise ValueError(&#34;y must have only 0.0 and 1.0&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = self.link(f)
        return torch.log(torch.where(0.5 &lt;= y, p, 1.0-p))  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        return self.link(f)

    def quantile(self, p, mu, var):
        return torch.where(p &lt;= 1.0-mu, 0.0, 1.0)

    def predict(self, mu, var, X=None, full=False):
        if self.link == inv_probit:
            p = self.link(mu / torch.sqrt(1.0 + var))
            if full:
                return p.diagonal().reshape(-1,1), p-p.square() # TODO: correct?
            return p, p-p.square()
        else:
            return super().predict(mu, var, X=X, full=full)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L292-L296" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = self.link(f)
    return torch.log(torch.where(0.5 &lt;= y, p, 1.0-p))  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, mu, var, X=None, full=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L307-L314" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predict(self, mu, var, X=None, full=False):
    if self.link == inv_probit:
        p = self.link(mu / torch.sqrt(1.0 + var))
        if full:
            return p.diagonal().reshape(-1,1), p-p.square() # TODO: correct?
        return p, p-p.square()
    else:
        return super().predict(mu, var, X=X, full=full)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L298-L299" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return self.link(f)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L301-L302" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    return self.link(f)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.quantile"><code class="name flex">
<span>def <span class="ident">quantile</span></span>(<span>self, p, mu, var)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L304-L305" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quantile(self, p, mu, var):
    return torch.where(p &lt;= 1.0-mu, 0.0, 1.0)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BernoulliLikelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L288-L290" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    if torch.any((y != 0.0) &amp; (y != 1.0)):
        raise ValueError(&#34;y must have only 0.0 and 1.0&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.BetaLikelihood"><code class="flex name class">
<span>class <span class="ident">BetaLikelihood</span></span>
<span>(</span><span>scale=1.0, link=&lt;function inv_probit&gt;, name='Beta', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L316-L346" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class BetaLikelihood(Likelihood):
    def __init__(self, scale=1.0, link=inv_probit, name=&#34;Beta&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link
        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def validate_y(self, y):
        if torch.any((y &lt;= 0.0) | (1.0 &lt;= y)):
            raise ValueError(&#34;y must be in the range (0.0,1.0)&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        mixture = self.link(f)
        alpha = mixture * self.scale()
        beta = (1.0-mixture) * self.scale()

        p = (alpha-1.0)*torch.log(y)
        p += (beta-1.0)*torch.log(1.0-y)
        p += torch.lgamma(alpha+beta)
        p -= torch.lgamma(alpha)
        p -= torch.lgamma(beta)
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        mixture = self.link(f)
        return (mixture + mixture.square()*self.scale()) / (self.scale() + 1.0)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.BetaLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L327-L339" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    mixture = self.link(f)
    alpha = mixture * self.scale()
    beta = (1.0-mixture) * self.scale()

    p = (alpha-1.0)*torch.log(y)
    p += (beta-1.0)*torch.log(1.0-y)
    p += torch.lgamma(alpha+beta)
    p -= torch.lgamma(alpha)
    p -= torch.lgamma(beta)
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BetaLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L341-L342" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return self.link(f)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BetaLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L344-L346" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    mixture = self.link(f)
    return (mixture + mixture.square()*self.scale()) / (self.scale() + 1.0)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.BetaLikelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L323-L325" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    if torch.any((y &lt;= 0.0) | (1.0 &lt;= y)):
        raise ValueError(&#34;y must be in the range (0.0,1.0)&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood"><code class="flex name class">
<span>class <span class="ident">ExponentialLikelihood</span></span>
<span>(</span><span>link=&lt;function exp&gt;, name='Exponential', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L234-L257" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class ExponentialLikelihood(Likelihood):
    def __init__(self, link=exp, name=&#34;Exponential&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link

    def validate_y(self, y):
        if torch.any(y &lt; 0.0):
            raise ValueError(&#34;y must be positive&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -y/self.link(f) - torch.log(self.link(f))
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.link(f)

    def predictive_yy(self, f, X=None):
        return 2.0*self.link(f)**2

    def quantile(self, p, mu, var):
        return -torch.log(1.0 - p) * mu</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L244-L248" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = -y/self.link(f) - torch.log(self.link(f))
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L250-L251" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return self.link(f)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L253-L254" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    return 2.0*self.link(f)**2</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood.quantile"><code class="name flex">
<span>def <span class="ident">quantile</span></span>(<span>self, p, mu, var)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L256-L257" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quantile(self, p, mu, var):
    return -torch.log(1.0 - p) * mu</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.ExponentialLikelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L240-L242" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    if torch.any(y &lt; 0.0):
        raise ValueError(&#34;y must be positive&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.GammaLikelihood"><code class="flex name class">
<span>class <span class="ident">GammaLikelihood</span></span>
<span>(</span><span>shape=1.0, link=&lt;function exp&gt;, name='Gamma', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L348-L373" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class GammaLikelihood(Likelihood):
    def __init__(self, shape=1.0, link=exp, name=&#34;Gamma&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.link = link
        self.shape = Parameter(shape, name=&#34;shape&#34;, lower=config.positive_minimum)

    def validate_y(self, y):
        if torch.any(y &lt;= 0.0):
            raise ValueError(&#34;y must be in the range (0.0,inf)&#34;)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -y/self.link(f)
        p += (self.shape()-1.0)*torch.log(y)
        p -= torch.lgamma(self.shape())
        p -= self.shape()*torch.log(self.link(f))
        return p  # NxM

    def predictive_y(self, f, X=None):
        return self.shape()*self.link(f)

    def predictive_yy(self, f, X=None):
        t = self.shape()*self.link(f)
        return t + t.square()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.GammaLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L359-L366" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = -y/self.link(f)
    p += (self.shape()-1.0)*torch.log(y)
    p -= torch.lgamma(self.shape())
    p -= self.shape()*torch.log(self.link(f))
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GammaLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L368-L369" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return self.shape()*self.link(f)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GammaLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L371-L373" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    t = self.shape()*self.link(f)
    return t + t.square()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GammaLikelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L355-L357" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    if torch.any(y &lt;= 0.0):
        raise ValueError(&#34;y must be in the range (0.0,inf)&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.GaussHermiteQuadrature"><code class="flex name class">
<span>class <span class="ident">GaussHermiteQuadrature</span></span>
<span>(</span><span>deg=20, t_scale=None, w_scale=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L19-L33" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class GaussHermiteQuadrature:
    def __init__(self, deg=20, t_scale=None, w_scale=None):
        t, w = np.polynomial.hermite.hermgauss(deg)
        t = t.reshape(-1,1)
        w = w.reshape(-1,1)
        if t_scale is not None:
            t *= t_scale
        if w_scale is not None:
            w *= w_scale
        self.t = torch.tensor(t, device=config.device, dtype=config.dtype)  # Mx1
        self.w = torch.tensor(w, device=config.device, dtype=config.dtype)  # Mx1
        self.deg = deg

    def __call__(self, mu, var, F):
        return F(mu + var.sqrt().mm(self.t.T)).mm(self.w)  # Nx1</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood"><code class="flex name class">
<span>class <span class="ident">GaussianLikelihood</span></span>
<span>(</span><span>variance=1.0, name='Gaussian', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L174-L206" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class GaussianLikelihood(Likelihood):
    def __init__(self, variance=1.0, name=&#34;Gaussian&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.variance = Parameter(variance, name=&#34;variance&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -0.5 * (np.log(2.0 * np.pi) + self.variance().log() + (y-f).square()/self.variance())
        return p  # NxM

    def variational_expectation(self, y, mu, var, X=None):
        # y,mu,var: Nx1
        p = -((y-mu).square() + var) / self.variance()
        p -= np.log(2.0 * np.pi)
        p -= self.variance().log()
        return 0.5*p.sum()  # sum over N

    def predictive_y(self, f, X=None):
        return f

    def predictive_yy(self, f, X=None):
        return f.square() + self.variance()

    def quantile(self, p, mu, var):
        return mu + torch.sqrt(2.0*var)*torch.erfinv(2.0*p - 1.0)

    def predict(self, mu, var, X=None, full=False):
        if full:
            return mu, var + self.variance()*torch.eye(var.shape[0])
        else:
            return mu, var + self.variance()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L180-L184" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = -0.5 * (np.log(2.0 * np.pi) + self.variance().log() + (y-f).square()/self.variance())
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, mu, var, X=None, full=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L202-L206" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predict(self, mu, var, X=None, full=False):
    if full:
        return mu, var + self.variance()*torch.eye(var.shape[0])
    else:
        return mu, var + self.variance()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L193-L194" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return f</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L196-L197" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    return f.square() + self.variance()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.quantile"><code class="name flex">
<span>def <span class="ident">quantile</span></span>(<span>self, p, mu, var)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L199-L200" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quantile(self, p, mu, var):
    return mu + torch.sqrt(2.0*var)*torch.erfinv(2.0*p - 1.0)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.GaussianLikelihood.variational_expectation"><code class="name flex">
<span>def <span class="ident">variational_expectation</span></span>(<span>self, y, mu, var, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L186-L191" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def variational_expectation(self, y, mu, var, X=None):
    # y,mu,var: Nx1
    p = -((y-mu).square() + var) / self.variance()
    p -= np.log(2.0 * np.pi)
    p -= self.variance().log()
    return 0.5*p.sum()  # sum over N</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.LaplaceLikelihood"><code class="flex name class">
<span>class <span class="ident">LaplaceLikelihood</span></span>
<span>(</span><span>scale=1.0, name='Laplace', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L259-L280" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class LaplaceLikelihood(Likelihood):
    def __init__(self, scale=1.0, name=&#34;Laplace&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -torch.log(2.0*self.scale()) - (y-f).abs()/self.scale()
        return p  # NxM

    def predictive_y(self, f, X=None):
        return f

    def predictive_yy(self, f, X=None):
        return f.square() + 2.0*self.scale()**2

    def quantile(self, p, mu, var):
        if p &lt; 0.5:
            return mu + self.scale()*torch.log(2.0*p)
        return mu - self.scale()*torch.log(2.0 - 2.0*p)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.LaplaceLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L265-L269" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = -torch.log(2.0*self.scale()) - (y-f).abs()/self.scale()
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.LaplaceLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L271-L272" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    return f</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.LaplaceLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L274-L275" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    return f.square() + 2.0*self.scale()**2</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.LaplaceLikelihood.quantile"><code class="name flex">
<span>def <span class="ident">quantile</span></span>(<span>self, p, mu, var)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L277-L280" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quantile(self, p, mu, var):
    if p &lt; 0.5:
        return mu + self.scale()*torch.log(2.0*p)
    return mu - self.scale()*torch.log(2.0 - 2.0*p)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood"><code class="flex name class">
<span>class <span class="ident">Likelihood</span></span>
<span>(</span><span>name='Likelihood', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L35-L75" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class Likelihood:
    def __init__(self, name=&#34;Likelihood&#34;, quadratures=20):
        self.name = name
        self.quadrature = GaussHermiteQuadrature(deg=quadratures, t_scale=np.sqrt(2), w_scale=1.0/np.sqrt(np.pi))
        self.output_dims = 1

    def validate_y(self, y):
        pass

    def log_prob(self, y, f, X=None):
        # log(p(y|f)), where p(y|f) is our likelihood
        # y: Nx1
        # f: NxM
        raise NotImplementedError()

    def variational_expectation(self, y, mu, var, X=None):
        # ∫ log(p(y|f)) q(f) df, where q(f) ~ N(mu,var) and p(y|f) is our likelihood
        # y,mu,var: Nx1
        q = self.quadrature(mu, var, lambda f: self.log_prob(y,f,X=X))  # Nx1
        return q.sum()  # sum over N

    def predictive_y(self, f, X=None):
        # f: NxM
        raise NotImplementedError()

    def predictive_yy(self, f, X=None):
        # f: NxM
        raise NotImplementedError()

    def quantile(self, p, mu, var):
        # p: scalar
        # mu,var: Nx1
        raise NotImplementedError()

    def predict(self, mu, var, X=None, full=False):
        # ∫∫ y p(y|f) q(f) df dy,  ∫∫ y^2 p(y|f) q(f) df dy - (∫∫ y p(y|f) q(f) df dy)^2
        # where q(f) ~ N(mu,var) and p(y|f) is our likelihood
        # mu,var: Nx1
        Ey = self.quadrature(mu, var, lambda f: self.predictive_y(f,X=X))
        Eyy = self.quadrature(mu, var, lambda f: self.predictive_yy(f,X=X))
        return Ey, Eyy-Ey**2</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.BernoulliLikelihood" href="#mogptk.gpr.likelihood.BernoulliLikelihood">BernoulliLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.BetaLikelihood" href="#mogptk.gpr.likelihood.BetaLikelihood">BetaLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.ExponentialLikelihood" href="#mogptk.gpr.likelihood.ExponentialLikelihood">ExponentialLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.GammaLikelihood" href="#mogptk.gpr.likelihood.GammaLikelihood">GammaLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.GaussianLikelihood" href="#mogptk.gpr.likelihood.GaussianLikelihood">GaussianLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.LaplaceLikelihood" href="#mogptk.gpr.likelihood.LaplaceLikelihood">LaplaceLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.MultiOutputLikelihood" href="#mogptk.gpr.likelihood.MultiOutputLikelihood">MultiOutputLikelihood</a></li>
<li><a title="mogptk.gpr.likelihood.StudentTLikelihood" href="#mogptk.gpr.likelihood.StudentTLikelihood">StudentTLikelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.Likelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L44-L48" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # log(p(y|f)), where p(y|f) is our likelihood
    # y: Nx1
    # f: NxM
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, mu, var, X=None, full=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L69-L75" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predict(self, mu, var, X=None, full=False):
    # ∫∫ y p(y|f) q(f) df dy,  ∫∫ y^2 p(y|f) q(f) df dy - (∫∫ y p(y|f) q(f) df dy)^2
    # where q(f) ~ N(mu,var) and p(y|f) is our likelihood
    # mu,var: Nx1
    Ey = self.quadrature(mu, var, lambda f: self.predictive_y(f,X=X))
    Eyy = self.quadrature(mu, var, lambda f: self.predictive_yy(f,X=X))
    return Ey, Eyy-Ey**2</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L56-L58" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    # f: NxM
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L60-L62" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    # f: NxM
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.quantile"><code class="name flex">
<span>def <span class="ident">quantile</span></span>(<span>self, p, mu, var)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L64-L67" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def quantile(self, p, mu, var):
    # p: scalar
    # mu,var: Nx1
    raise NotImplementedError()</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L41-L42" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    pass</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.Likelihood.variational_expectation"><code class="name flex">
<span>def <span class="ident">variational_expectation</span></span>(<span>self, y, mu, var, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L50-L54" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def variational_expectation(self, y, mu, var, X=None):
    # ∫ log(p(y|f)) q(f) df, where q(f) ~ N(mu,var) and p(y|f) is our likelihood
    # y,mu,var: Nx1
    q = self.quadrature(mu, var, lambda f: self.log_prob(y,f,X=X))  # Nx1
    return q.sum()  # sum over N</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood"><code class="flex name class">
<span>class <span class="ident">MultiOutputLikelihood</span></span>
<span>(</span><span>*likelihoods, name='MultiOutputLikelihood', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L77-L172" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class MultiOutputLikelihood(Likelihood):
    def __init__(self, *likelihoods, name=&#34;MultiOutputLikelihood&#34;, quadratures=20):
        super().__init__(name=name, quadratures=quadratures)

        if isinstance(likelihoods, tuple):
            if len(likelihoods) == 1 and isinstance(likelihoods[0], list):
                likelihoods = likelihoods[0]
            else:
                likelihoods = list(likelihoods)
        elif not isinstance(likelihoods, list):
            likelihoods = [likelihoods]
        if len(likelihoods) == 0:
            raise ValueError(&#34;must pass at least one likelihood&#34;)
        for i, likelihood in enumerate(likelihoods):
            if not issubclass(type(likelihood), Likelihood):
                raise ValueError(&#34;must pass likelihoods&#34;)
            elif isinstance(likelihood, MultiOutputLikelihood):
                raise ValueError(&#34;can not nest MultiOutputLikelihoods&#34;)

        self.output_dims = len(likelihoods)
        self.likelihoods = likelihoods

    def _channel_indices(self, X):
        c = X[:,0].long()
        m = [c==j for j in range(self.output_dims)]
        r = [torch.nonzero(m[j], as_tuple=False).reshape(-1) for j in range(self.output_dims)]  # as_tuple avoids warning
        return r

    def validate_y(self, y):
        for likelihood in likelihoods:
            likelihood.validate_y(y)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].log_prob(y,f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].log_prob(y[r[i],:], f[r[i],:])
        return res  # NxM

    def variational_expectation(self, y, mu, var, X=None):
        # y,mu,var: Nx1
        if self.output_dims == 1:
            return self.likelihoods[0].variational_expectation(y,mu,var)

        q = torch.tensor(0.0, dtype=config.dtype, device=config.device)
        r = self._channel_indices(X)
        for i in range(self.output_dims):
            q += self.likelihoods[i].variational_expectation(y[r[i],:], mu[r[i],:], var[r[i],:]).sum()  # sum over N
        return q

    def predictive_y(self, f, X=None):
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].predictive_y(f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].predictive_y(f[r[i],:])
        return res  # NxM

    def predictive_yy(self, f, X=None):
        # f: NxM
        if self.output_dims == 1:
            return self.likelihoods[0].predictive_yy2(f)

        r = self._channel_indices(X)
        res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
        for i in range(self.output_dims):
            res[r[i],:] = self.likelihoods[i].predictive_yy(f[r[i],:])
        return res  # NxM

    # TODO: predict is not possible?
    #def predict(self, mu, var, X=None, full=False):
    #    # mu: Nx1
    #    # var: Nx1 or NxN
    #    if self.output_dims == 1:
    #        return self.likelihoods[0].predict(mu,var,full=full)

    #    r = self._channel_indices(X)
    #    Ey = torch.empty(mu.shape, device=config.device, dtype=config.dtype)
    #    Eyy = torch.empty(var.shape, device=config.device, dtype=config.dtype)
    #    if full:
    #        for i in range(self.output_dims):
    #            r1 = r[i].reshape(-1,1)
    #            r2 = r[i].reshape(1,-1)
    #            Ey[r[i],:], Eyy[r1,r2] = self.likelihoods[i].predict(mu[r[i],:], var[r1,r2], full=True)
    #    else:
    #        for i in range(self.output_dims):
    #            Ey[r[i],:], Eyy[r[i],:] = self.likelihoods[i].predict(mu[r[i],:], var[r[i],:], full=False)
    #    return Ey, Eyy-Ey.square()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L109-L119" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    if self.output_dims == 1:
        return self.likelihoods[0].log_prob(y,f)

    r = self._channel_indices(X)
    res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
    for i in range(self.output_dims):
        res[r[i],:] = self.likelihoods[i].log_prob(y[r[i],:], f[r[i],:])
    return res  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L132-L141" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    # f: NxM
    if self.output_dims == 1:
        return self.likelihoods[0].predictive_y(f)

    r = self._channel_indices(X)
    res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
    for i in range(self.output_dims):
        res[r[i],:] = self.likelihoods[i].predictive_y(f[r[i],:])
    return res  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L143-L152" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    # f: NxM
    if self.output_dims == 1:
        return self.likelihoods[0].predictive_yy2(f)

    r = self._channel_indices(X)
    res = torch.empty(f.shape, device=config.device, dtype=config.dtype)
    for i in range(self.output_dims):
        res[r[i],:] = self.likelihoods[i].predictive_yy(f[r[i],:])
    return res  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood.validate_y"><code class="name flex">
<span>def <span class="ident">validate_y</span></span>(<span>self, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L105-L107" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def validate_y(self, y):
    for likelihood in likelihoods:
        likelihood.validate_y(y)</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.MultiOutputLikelihood.variational_expectation"><code class="name flex">
<span>def <span class="ident">variational_expectation</span></span>(<span>self, y, mu, var, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L121-L130" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def variational_expectation(self, y, mu, var, X=None):
    # y,mu,var: Nx1
    if self.output_dims == 1:
        return self.likelihoods[0].variational_expectation(y,mu,var)

    q = torch.tensor(0.0, dtype=config.dtype, device=config.device)
    r = self._channel_indices(X)
    for i in range(self.output_dims):
        q += self.likelihoods[i].variational_expectation(y[r[i],:], mu[r[i],:], var[r[i],:]).sum()  # sum over N
    return q</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="mogptk.gpr.likelihood.StudentTLikelihood"><code class="flex name class">
<span>class <span class="ident">StudentTLikelihood</span></span>
<span>(</span><span>dof=3, scale=1.0, name='StudentT', quadratures=20)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L208-L232" class="git-link">Browse git</a>
</summary>
<pre><code class="python">class StudentTLikelihood(Likelihood):
    def __init__(self, dof=3, scale=1.0, name=&#34;StudentT&#34;, quadratures=20):
        super().__init__(name, quadratures)

        self.dof = torch.tensor(dof, device=config.device, dtype=config.dtype)
        self.scale = Parameter(scale, name=&#34;scale&#34;, lower=config.positive_minimum)

    def log_prob(self, y, f, X=None):
        # y: Nx1
        # f: NxM
        p = -0.5 * (self.dof+1.0)*torch.log(1.0 + ((y-f)/self.scale()).square()/self.dof)
        p += torch.lgamma((self.dof+1.0)/2.0)
        p -= torch.lgamma(self.dof/2.0)
        p -= 0.5 * torch.log(self.dof*np.pi*self.scale()**2)
        return p  # NxM

    def predictive_y(self, f, X=None):
        if self.dof &lt;= 1.0:
            return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
        return f

    def predictive_yy(self, f, X=None):
        if self.dof &lt;= 2.0:
            return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
        return f.square() + self.scale()**2 * self.dof/(self.dof-2.0)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="mogptk.gpr.likelihood.StudentTLikelihood.log_prob"><code class="name flex">
<span>def <span class="ident">log_prob</span></span>(<span>self, y, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L215-L222" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def log_prob(self, y, f, X=None):
    # y: Nx1
    # f: NxM
    p = -0.5 * (self.dof+1.0)*torch.log(1.0 + ((y-f)/self.scale()).square()/self.dof)
    p += torch.lgamma((self.dof+1.0)/2.0)
    p -= torch.lgamma(self.dof/2.0)
    p -= 0.5 * torch.log(self.dof*np.pi*self.scale()**2)
    return p  # NxM</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.StudentTLikelihood.predictive_y"><code class="name flex">
<span>def <span class="ident">predictive_y</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L224-L227" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_y(self, f, X=None):
    if self.dof &lt;= 1.0:
        return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
    return f</code></pre>
</details>
</dd>
<dt id="mogptk.gpr.likelihood.StudentTLikelihood.predictive_yy"><code class="name flex">
<span>def <span class="ident">predictive_yy</span></span>(<span>self, f, X=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/GAMES-UChile/mogptk/blob/f368a16bfb1504832f678b0335e6773127aade67/mogptk/gpr/likelihood.py#L229-L232" class="git-link">Browse git</a>
</summary>
<pre><code class="python">def predictive_yy(self, f, X=None):
    if self.dof &lt;= 2.0:
        return torch.full(f.shape, np.nan, device=config.device, dtype=config.dtype)
    return f.square() + self.scale()**2 * self.dof/(self.dof-2.0)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="mogptk.gpr" href="index.html">mogptk.gpr</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.exp" href="#mogptk.gpr.likelihood.exp">exp</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.identity" href="#mogptk.gpr.likelihood.identity">identity</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.inv_probit" href="#mogptk.gpr.likelihood.inv_probit">inv_probit</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.logistic" href="#mogptk.gpr.likelihood.logistic">logistic</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood" href="#mogptk.gpr.likelihood.BernoulliLikelihood">BernoulliLikelihood</a></code></h4>
<ul class="two-column">
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.log_prob" href="#mogptk.gpr.likelihood.BernoulliLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.predict" href="#mogptk.gpr.likelihood.BernoulliLikelihood.predict">predict</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.predictive_y" href="#mogptk.gpr.likelihood.BernoulliLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.BernoulliLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.quantile" href="#mogptk.gpr.likelihood.BernoulliLikelihood.quantile">quantile</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BernoulliLikelihood.validate_y" href="#mogptk.gpr.likelihood.BernoulliLikelihood.validate_y">validate_y</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.BetaLikelihood" href="#mogptk.gpr.likelihood.BetaLikelihood">BetaLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.BetaLikelihood.log_prob" href="#mogptk.gpr.likelihood.BetaLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BetaLikelihood.predictive_y" href="#mogptk.gpr.likelihood.BetaLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BetaLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.BetaLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.BetaLikelihood.validate_y" href="#mogptk.gpr.likelihood.BetaLikelihood.validate_y">validate_y</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood" href="#mogptk.gpr.likelihood.ExponentialLikelihood">ExponentialLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood.log_prob" href="#mogptk.gpr.likelihood.ExponentialLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood.predictive_y" href="#mogptk.gpr.likelihood.ExponentialLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.ExponentialLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood.quantile" href="#mogptk.gpr.likelihood.ExponentialLikelihood.quantile">quantile</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.ExponentialLikelihood.validate_y" href="#mogptk.gpr.likelihood.ExponentialLikelihood.validate_y">validate_y</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.GammaLikelihood" href="#mogptk.gpr.likelihood.GammaLikelihood">GammaLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.GammaLikelihood.log_prob" href="#mogptk.gpr.likelihood.GammaLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GammaLikelihood.predictive_y" href="#mogptk.gpr.likelihood.GammaLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GammaLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.GammaLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GammaLikelihood.validate_y" href="#mogptk.gpr.likelihood.GammaLikelihood.validate_y">validate_y</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.GaussHermiteQuadrature" href="#mogptk.gpr.likelihood.GaussHermiteQuadrature">GaussHermiteQuadrature</a></code></h4>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.GaussianLikelihood" href="#mogptk.gpr.likelihood.GaussianLikelihood">GaussianLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.log_prob" href="#mogptk.gpr.likelihood.GaussianLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.predict" href="#mogptk.gpr.likelihood.GaussianLikelihood.predict">predict</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.predictive_y" href="#mogptk.gpr.likelihood.GaussianLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.GaussianLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.quantile" href="#mogptk.gpr.likelihood.GaussianLikelihood.quantile">quantile</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.GaussianLikelihood.variational_expectation" href="#mogptk.gpr.likelihood.GaussianLikelihood.variational_expectation">variational_expectation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.LaplaceLikelihood" href="#mogptk.gpr.likelihood.LaplaceLikelihood">LaplaceLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.LaplaceLikelihood.log_prob" href="#mogptk.gpr.likelihood.LaplaceLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.LaplaceLikelihood.predictive_y" href="#mogptk.gpr.likelihood.LaplaceLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.LaplaceLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.LaplaceLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.LaplaceLikelihood.quantile" href="#mogptk.gpr.likelihood.LaplaceLikelihood.quantile">quantile</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.Likelihood" href="#mogptk.gpr.likelihood.Likelihood">Likelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.Likelihood.log_prob" href="#mogptk.gpr.likelihood.Likelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.predict" href="#mogptk.gpr.likelihood.Likelihood.predict">predict</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.predictive_y" href="#mogptk.gpr.likelihood.Likelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.predictive_yy" href="#mogptk.gpr.likelihood.Likelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.quantile" href="#mogptk.gpr.likelihood.Likelihood.quantile">quantile</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.validate_y" href="#mogptk.gpr.likelihood.Likelihood.validate_y">validate_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.Likelihood.variational_expectation" href="#mogptk.gpr.likelihood.Likelihood.variational_expectation">variational_expectation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood" href="#mogptk.gpr.likelihood.MultiOutputLikelihood">MultiOutputLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood.log_prob" href="#mogptk.gpr.likelihood.MultiOutputLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_y" href="#mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.MultiOutputLikelihood.predictive_yy">predictive_yy</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood.validate_y" href="#mogptk.gpr.likelihood.MultiOutputLikelihood.validate_y">validate_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.MultiOutputLikelihood.variational_expectation" href="#mogptk.gpr.likelihood.MultiOutputLikelihood.variational_expectation">variational_expectation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="mogptk.gpr.likelihood.StudentTLikelihood" href="#mogptk.gpr.likelihood.StudentTLikelihood">StudentTLikelihood</a></code></h4>
<ul class="">
<li><code><a title="mogptk.gpr.likelihood.StudentTLikelihood.log_prob" href="#mogptk.gpr.likelihood.StudentTLikelihood.log_prob">log_prob</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.StudentTLikelihood.predictive_y" href="#mogptk.gpr.likelihood.StudentTLikelihood.predictive_y">predictive_y</a></code></li>
<li><code><a title="mogptk.gpr.likelihood.StudentTLikelihood.predictive_yy" href="#mogptk.gpr.likelihood.StudentTLikelihood.predictive_yy">predictive_yy</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>